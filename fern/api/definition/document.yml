# yaml-language-server: $schema=https://raw.githubusercontent.com/fern-api/fern/main/fern.schema.json

imports: 
  commons: commons.yml

service:
  auth: true
  base-path: /v1
  endpoints:
    upload:
      url: Document
      path: /upload-document
      method: POST
      request: 
        name: UploadDocumentRequest
        body: 
          properties: 
            add_to_index_names: optional<list<string>>
            external_id: optional<string>
            label: string
            contents: file
            keywords: optional<list<string>>
      response: UploadDocumentResponse
      errors: 
        - commons.BadRequestError
        - commons.NotFoundError
        - commons.InternalServerError
    
    list:
      url: Default
      path: /documents
      method: GET
      docs: >
        <strong style="background-color:#4caf50; color:white; padding:4px;
        border-radius:4px">Stable</strong>
        Used to list documents. Optionally filter on supported fields.
      request:
        name: ListDocumentsRequest
        query-parameters:
          document_index_id:
            docs: >-
              Filter down to only those documents that are included in the
              specified index. You may provide either the Vellum-generated ID or
              the unique name of the index specified upon initial creation.
            type: optional<string>
          limit:
            docs: Number of results to return per page.
            type: optional<integer>
          offset:
            docs: The initial index from which to return the results.
            type: optional<integer>
          ordering:
            docs: Which field to use when ordering the results.
            type: optional<string>
      response: PaginatedSlimDocumentList

types:
  UploadDocumentResponse:
    properties:
      document_id: uuid

  PaginatedSlimDocumentList:
    properties:
      count: optional<integer>
      next: optional<string>
      previous: optional<string>
      results: optional<list<SlimDocument>>

  SlimDocument:
    properties:
      id:
        docs: Vellum-generated ID that uniquely identifies this document.
        type: string
      external_id:
        docs: >-
          The external ID that was originally provided when uploading the
          document.
        type: optional<string>
      last_uploaded_at:
        docs: >-
          A timestamp representing when this document was most recently
          uploaded.
        type: string
      label:
        docs: Human-friendly name for this document.
        type: string
      processing_state:
        docs: The current processing state of the document
        type: optional<ProcessingStateEnum>
      status:
        docs: The document's current status.
        type: optional<StatusEnum>
      keywords:
        docs: >-
          A list of keywords associated with this document. Originally provided
          when uploading the document.
        type: optional<list<string>>
      document_to_document_indexes: list<DocumentToDocumentIndex>

  ProcessingStateEnum:
    enum:
      - QUEUED
      - PROCESSING
      - PROCESSED
      - FAILED

  StatusEnum:
    enum:
      - ACTIVE

  DocumentToDocumentIndex:
    properties:
      id:
        docs: Vellum-generated ID that uniquely identifies this link.
        type: string
      document_index_id:
        docs: >-
          Vellum-generated ID that uniquely identifies the index this document
          is included in.
        type: string
      indexing_state:
        docs: >-
          An enum value representing where this document is along its indexing
          lifecycle for this index.
        type: optional<IndexingStateEnum>

  IndexingStateEnum:
    enum:
      - AWAITING_PROCESSING
      - QUEUED
      - INDEXING
      - INDEXED
      - FAILED
